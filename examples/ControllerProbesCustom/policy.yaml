apiVersion: magalix.com/v1
kind: Policy
metadata:
  name: magalix.templates.container-custom-probe
spec:
  id: magalix.templates.container-custom-probe
  name: Container Custom Probe
  description: |
    This Policy allows defining the various container probes, and ensures consistent probes are configured across all containers. You can set the type of probe `livenessProbe`, `readinessProbe`, `startupProbe` along with a `command`, a `path` and a `port`. 
  how_to_solve: |
    ```
    ...
      spec:
        containers:
        - container1
          <probe_type>:
            exec:
              command: 
              - <command>
        - container2
          <probe_type>:
            httpGet:
              path: <path>
              port: <port>
    ```
    https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-a-tcp-liveness-probe
  category: magalix.categories.reliability
  severity: high
  parameters:
  - name: probe_type
    type: string
    required: true
    default:
  - name: command
    type: array
    required: false
    default:
  - name: path
    type: string
    required: false
    default:
  - name: port
    type: integer
    required: false
    default:
  - name: exclude_namespace
    type: string
    required: false
    default:
  - name: exclude_label_key
    type: string
    required: false
    default:
  - name: exclude_label_value
    type: string
    required: false
    default:
