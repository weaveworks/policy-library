enable: true
name: magalix.policies.rbac-prohibit-resources-wildcards
description: |
  This Policy prohbits various resources from being set with wildcards for Role or ClusterRole resources, except for the `cluster-admin` ClusterRole. It will check each resource specified for the verb specified. The wildcards will be checked in:

  ### Resources
  In the Kubernetes API, most resources are represented and accessed using a string representation of their object name, such as pods for a Pod. RBAC refers to resources using exactly the same name that appears in the URL for the relevant API endpoint. 

  ### Verbs
  API verbs like get, list, create, update, patch, watch, delete, and deletecollection are used for resource requests. 

  ### API Groups
  The API Group being accessed (for resource requests only).

  ### Non Resource URLs
  Requests to endpoints other than /api/v1/... or /apis/<group>/<version>/... are considered "non-resource requests", and use the lower-cased HTTP method of the request as the verb.
how_to_solve: |
  Replace the `*` with the appropriate resource. The type of 
  ```
  rules:
  - <attributes>:
    - '*'
      
  ```
  https://kubernetes.io/docs/reference/access-authn-authz/rbac/
category: magalix.categories.access-control
severity: high
controls:
- magalix.controls.pci-dss.7.1.1
- magalix.controls.pci-dss.7.1.2
- magalix.controls.cis-benchmark.5.1.3
- magalix.controls.gdpr.25
- magalix.controls.gdpr.32
- magalix.controls.gdpr.24
- magalix.controls.soc2-type1.1.6.3
parameters:
- default:
  name: attributes
  required: true
  type: string
- default:
  name: exclude_role_name
  required: true
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
