apiVersion: pac.weave.works/v2beta1
kind: Policy
metadata:
  name: weave.templates.metadata-missing-label-and-value
spec:
  id: weave.templates.metadata-missing-label-and-value
  name: Metadata Missing Label And Value
  description: |
    Custom labels can help enforce organizational standards for each artifact deployed. This Policy ensures a key and value are set in the entity's `metadata.labels` path. The Policy detects the presence of the following: 

    ### label
    A label key of your choosing. 

    ### value
    A label value of your choosing.
  how_to_solve: |
    Add a custom label and value to `metadata.labels`.

    ```
    metadata:
      labels:
        <label>: <value>
    ```  
    For additional information, please check
    * https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels 
  category: weave.categories.organizational-standards
  severity: low
  parameters:
  - name: label
    type: string
    required: true
    value:
  - name: value
    type: string
    required: true
    value:
  - name: exclude_namespace
    type: string
    required: false
    value:
  - name: exclude_label_key
    type: string
    required: false
    value:
  - name: exclude_label_value
    type: string
    required: false
    value:
