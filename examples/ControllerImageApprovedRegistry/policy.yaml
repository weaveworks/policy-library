apiVersion: pac.weave.works/v1
kind: Policy
metadata:
  name: weave.templates.approved-registry
spec:
  id: weave.templates.approved-registry
  name: Approved Registry
  description: |
    This Policy is violated when container images are not using approved container registries. The Policy allows for you to add multiple registries. 
  how_to_solve: |
    Ensure the image registry you are using matches the registries specified in the policy. If you are using multiple containers, be sure to check those as well. 

    Replace the violating registry with one that is approved. 
    ```
    ...
      spec:
        template:
          spec:
            containers:
            - image:<registries>/container_name:tag
    ```
  category: weave.categories.software-supply-chain
  severity: high
  controls:
  - weave.controls.soc2-type-i.1.6.8
  parameters:
  - name: registries
    type: array
    required: true
    value:
  - name: exclude_namespace
    type: string
    required: false
    value:
  - name: exclude_label_key
    type: string
    required: false
    value:
  - name: exclude_label_value
    type: string
    required: false
    value:
