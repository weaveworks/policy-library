apiVersion: magalix.com/v1
kind: Policy
metadata:
  name: magalix.templates.affinity-node-selector
spec:
  id: magalix.templates.affinity-node-selector
  name: Affinity Node Selector
  description: |
    This Policy allows setting a key and value for `nodeSelector` when assigning pods to nodes. 

    `nodeSelector` is a field of PodSpec. It specifies a map of key-value pairs. For the pod to be eligible to scheduled on a node, the node must have each of the indicated key-value pairs as labels (it can have additional labels as well). 
  how_to_solve: |
    When working with with `nodeSelector`, the indicated key-value pair will be matched to a node label.  

    ```
    ...
      spec:
        nodeSelector:
          <key>: <value>
    ```
    https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector
  category: magalix.categories.capacity-management
  severity: medium
  controls:
  - magalix.controls.soc2-type-1.2.1.1
  parameters:
  - name: key
    type: string
    required: true
    default:
  - name: value
    type: string
    required: true
    default:
  - name: exclude_namespace
    type: string
    required: false
    default:
  - name: exclude_label_key
    type: string
    required: false
    default:
  - name: exclude_label_value
    type: string
    required: false
    default:
