apiVersion: pac.weave.works/v2beta1
kind: Policy
metadata:
  name: weave.templates.persistent-volume-claim-snapshot
spec:
  id: weave.templates.persistent-volume-claim-snapshot
  name: Persistent Volume Claim Snapshot
  description: "This Policy checks for a PVC Snapshot. \n"
  how_to_solve: "When using Persistent Volume Claim snapshots, ensure both the `snapshot_class` and `pvc_name` define match what's in the Policy. \n```\nspec:\n  volumeSnapshotClassName: <snapshot_class>\n  source:\n    persistentVolumeClaimName: <pvc_name>\n```\n"
  category: weave.categories.capacity-management
  severity: medium
  standards:
    - id: weave.standards.soc2-type-i
      controls:
        - weave.controls.soc2-type-i.2.1.2
  parameters:
    - name: snapshot_class
      type: string
      required: true
      value:
    - name: pvc_name
      type: string
      required: true
      value:
    - name: exclude_label_key
      type: string
      required: false
      value:
    - name: exclude_label_value
      type: string
      required: false
      value:
