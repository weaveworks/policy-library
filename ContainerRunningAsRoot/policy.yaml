sync: true
enabled: true
name: MGLX_CONTAINER_RUNNING_AS_ROOT
description: |
  Running as root gives the container full access to all resources in the VM it is running on. Containers should not run with such access rights unless required by design. This Policy enforces that the `securityContext.runAsNonRoot` attribute is set to `true`. 
risks: |
  If containers are running as root within your Kubernetes cluster, and that container is somehow compromised, an attacker could potentially have root privileges on the host that the container is running on. With root privileges at the host level, an attacker can launch a number of additional processes to do whatever they want. Manually enforcing the usage of a user that isnâ€™t root within your containers can become an impossible feat. 
how_to_solve: |
  You should set `securityContext.runAsNonRoot` to `true`. Not setting it will default to giving the container root user rights on the VM that it is running on. 
  ```
  ...
    spec:
      securityContext:
        runAsNonRoot: true
  ```
  https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
category_id: af500588-3f73-4e56-8d1a-267852a969b8
severity: high
targets: [
  "Deployment",
  "Job",
  "ReplicationController",
  "ReplicaSet",
  "DaemonSet",
  "StatefulSet",
  "CronJob",
]
controls:
- 61ac439c-e16e-4964-8940-99ffc5eb60aa
- 38afd77f-2bd5-44b9-b813-f6bcd4b83f8f 
- dfe2bb11-485d-4b62-8095-85b20f36721e
- ce30268a-5626-4ff3-b313-66def20555d7
- d45d50c2-bf1e-4dff-9f7e-0adf97f741ef
- 6ba714ba-f225-45fb-8e54-270baf987310
- d22c177c-45a6-42f2-b928-75d15f0ecb0a
- 4117f4a7-9263-4643-8b31-4aa9d639fdb5
tags: [
  "pci-dss",
  "cis-benchmark",
  "mitre-attack",
  "nist800-190",
  "gdpr",
  "default",
]
exclusions:
- namespaces
- labels
auto_remedy: false
parameters:
- default: kube-system
  name: exclude_namespace
  required: false
  type: string
- default: 
  name: exclude_label_key
  required: false
  type: string
- default: 
  name: exclude_label_value
  required: false
  type: string