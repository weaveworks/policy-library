apiVersion: pac.weave.works/v1
kind: Policy
metadata:
  name: weave.policies.prohibit-naked-pods-from-being-scheduled
spec:
  id: weave.policies.prohibit-naked-pods-from-being-scheduled
  name: Prohibit Naked Pods From Being Scheduled
  enabled: true
  description: |
    This Policy checks for a `kind` and can prohibit it from being schedule to your cluster. A common example is running "naked" pods. 
  how_to_solve: |
    Ensure you are not using a kind that is specified within the Policy.
    ```
    kind: <kind>
    ```

    https://kubernetes.io/docs/concepts/configuration/overview/#naked-pods-vs-replicasets-deployments-and-jobs
  category: weave.categories.organizational-standards
  severity: medium
  targets: {kinds: [Pod]}
  standards:
  - id: weave.standards.cis-benchmark
    controls:
    - weave.controls.cis-benchmark.5.1.4
  tags: [cis-benchmark]
