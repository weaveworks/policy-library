name: magalix.policies.containers-using-hostpath
description: |
  This Policy checks for containers that are trying to use HostPath. 

  A `hostPath` volume mounts a file or directory from the host node's filesystem into your Pod. This is not something that most Pods will need, but it offers a powerful escape hatch for some applications.
how_to_solve: |
  Using HostPath could allow mounting the entire host’s filesystem into your pod, giving you read/write access on the host’s filesystem. This leaves your cluster vulnerable to escape Kubernetes constraints and access components at the Node (OS) level. 
  ```
  ...
    spec:
      template:
        spec:
          volumes:
            - hostPath:
  ```
category: magalix.categories.pod-security
severity: high
targets: {kind: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
    CronJob]}
controls:
- magalix.controls.mitre-attack.3.2
- magalix.controls.nist-800-190.4.4.5
- magalix.controls.gdpr.25
- magalix.controls.gdpr.32
- magalix.controls.gdpr.24
tags: [mitre-attack, nist800-190, gdpr, default]
parameters:
- default: hostPath
  name: hostpath_key
  required: true
  type: string
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
