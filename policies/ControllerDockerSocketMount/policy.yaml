name: Containers mounting Docker socket
description: |
  This Policy checks the mounting of the `docker.sock` socket of the node into the container. The docker socket filename can be altered based on your configuration. The full path is unnecessary as the Policy accounts for any path.  
how_to_solve: |
  Ensure workloads aren't mounting the `docker.sock` (or other configured socket name) in order to avoid a violation. 
  ```
  ...
    spec:
      template:
        spec:
          volumes:
            - name: docker-sock
              hostPath:
                path: "<path>/<this value>"
                type: File
  ```
category: magalix.categories.pod-security
severity: high
targets: {kind: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
    CronJob]}
controls:
- magalix.controls.nist-800-190.4.4.3
- magalix.controls.gdpr.25
- magalix.controls.gdpr.32
- magalix.controls.gdpr.24
tags: [nist800-190, gdpr, default]
parameters:
- default: docker.sock
  name: docker_sock
  required: true
  type: string
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
