name: Services prohibit type
description: |
  This Policy checks your Kubernetes Service kind to see what Service type is set. If a specified service type is found, this Policy will be in violation. Security practices suggest using types `ServiceType` of `ClusterIP` or `LoadBalancer` and not `NodePort`. 
how_to_solve: |
  Ensure the type matches what is specified in the Policy. 
  ```
  spec:
    type: <type>
  ```

  https://kubernetes.io/docs/concepts/services-networking/service/#nodeport
category: magalix.categories.network-security
severity: high
targets: {kind: [Service]}
controls:
- magalix.controls.pci-dss.1.1.6
- magalix.controls.pci-dss.1.3.1
- magalix.controls.pci-dss.2.2.2
tags: [pci-dss]
parameters:
- default: NodePort
  name: type
  required: true
  type: string
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string

