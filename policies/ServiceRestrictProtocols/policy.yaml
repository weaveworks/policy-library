enable: true
name: magalix.policies.services-restrict-protocols
description: |
  This Policy specifies what protocols should set for your Service. Any protocol not listed in this Policy will be in violation. 
how_to_solve: |
  Use a protocol that is specified in the Policy. 
  ```
  spec:
    ports:
      - protocol: <protocols>
  ```
category: magalix.categories.network-security
severity: high
targets: {kind: [Service]}
controls:
- magalix.controls.pci-dss.1.1.6
- magalix.controls.pci-dss.1.3.1
- magalix.controls.soc2-type1.1.6.7
tags: [pci-dss, soc2-type1]
parameters:
- default: HTTPS
  name: protocols
  required: true
  type: string
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
