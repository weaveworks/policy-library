enable: true
name: magalix.policies.containers-block-ssh-port
description: |
  This Policy checks if the container is exposing ssh port.
how_to_solve: |
  Make sure you are not exposing ssh port on containers.
  ```
  ...
    spec:
      containers:
        ports:
        - containerPort: <port>
  ```
category: magalix.categories.network-security
severity: high
targets: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
  CronJob]
controls:
- magalix.controls.pci-dss.1.1.6
- magalix.controls.pci-dss.1.3.1
- magalix.controls.pci-dss.2.2.2
tags: [pci-dss]
parameters:
- name: container_port
  type: integer
  required: true
  default: 22
- name: exclude_namespace
  type: string
  required: false
  default:
- name: exclude_label_key
  type: string
  required: false
  default:
- name: exclude_label_value
  type: string
  required: false
  default:
