name: magalix.policies.container-running-as-root
description: |
  Running as root gives the container full access to all resources in the VM it is running on. Containers should not run with such access rights unless required by design. This Policy enforces that the `securityContext.runAsNonRoot` attribute is set to `true`. 
how_to_solve: |
  You should set `securityContext.runAsNonRoot` to `true`. Not setting it will default to giving the container root user rights on the VM that it is running on. 
  ```
  ...
    spec:
      securityContext:
        runAsNonRoot: true
  ```
  https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
category: magalix.categories.pod-security
severity: high
targets: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
  CronJob]
controls:
- magalix.controls.pci-dss.2.2.4
- magalix.controls.pci-dss.2.2.5
- magalix.controls.cis-benchmark.5.2.6
- magalix.controls.mitre-attack.4.1
- magalix.controls.nist-800-190.3.3.1
- magalix.controls.gdpr.24
- magalix.controls.gdpr.25
- magalix.controls.gdpr.32
tags: [pci-dss, cis-benchmark, mitre-attack, nist800-190, gdpr, default]
parameters:
- default: kube-system
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
