name: Containers using hostPort
description: |
  This Policy checks if `hostPort` is set. When `hostPort` is set, a Pod is bound to a hostPort and limits the number of places the Pod can be scheduled. That's because each <hostIP, hostPort, protocol> combination must be unique. If you don't specify the hostIP and protocol explicitly, Kubernetes will use 0.0.0.0 as the default hostIP and TCP as the default protocol.

  Don't specify a hostPort for a Pod unless it is absolutely necessary.  
how_to_solve: |
  Try avoid setting `hostPort` in your spec. 
  ```
  ...
    spec:
      containers:
      - ports:
        - hostPort: 8080
  ```
  https://kubernetes.io/docs/concepts/configuration/overview/#services
category: magalix.categories.network-security
severity: high
targets: {kind: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
    CronJob]}
controls:
- magalix.controls.pci-dss.2.2.2
- magalix.controls.nist-800-190.4.4.2
tags: [pci-dss, nist800-190]
parameters:
- default: hostPort
  name: host_port
  required: true
  type: string
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
