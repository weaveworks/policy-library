apiVersion: magalix.com/v1
kind: Policy
metadata:
  name: magalix.policies.container-block-sysctl.cve-2022-0811
spec:
  id: magalix.policies.container-block-sysctl.cve-2022-0811
  name: Container Block Sysctls CVE-2022-0811
  description: |
    Setting sysctls can allow containers unauthorized escalated privileges to a Kubernetes node. 
  how_to_solve: |
    You should not set `securityContext.sysctls.value` to include `+` or `=` characters. 
    ```
    ...
      spec:
        securityContext:
          sysctls: 
            - name: name
              value "1+2=3"
    ```
    ```
    https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
    https://www.crowdstrike.com/blog/cr8escape-new-vulnerability-discovered-in-cri-o-container-engine-cve-2022-0811/
  category: magalix.categories.pod-security
  severity: high
  targets: {kinds: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet,
      StatefulSet, CronJob]}
  controls:
  - magalix.controls.pci-dss.2.2.4
  - magalix.controls.pci-dss.2.2.5
  - magalix.controls.cis-benchmark.5.2.6
  - magalix.controls.mitre-attack.4.1
  - magalix.controls.nist-800-190.3.3.1
  - magalix.controls.gdpr.24
  - magalix.controls.gdpr.25
  - magalix.controls.gdpr.32
  tags: [pci-dss, cis-benchmark, mitre-attack, nist800-190, gdpr, default]
  parameters:
  - name: exclude_namespace
    type: string
    required: false
    value: kube-system
  - name: exclude_label_key
    type: string
    required: false
    value:
  - name: exclude_label_value
    type: string
    required: false
    value:
