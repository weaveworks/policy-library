name: magalix.policies.containers-running-in-privileged-mode
description: |
  This Policy reports if containers are running in privileged mode. A privileged container is given access to all devices on the host. This allows the container nearly all the same access as processes running on the host.

  By default a container is not allowed to access any devices on the host, but a "privileged" container is given access to all devices on the host. This allows the container nearly all the same access as processes running on the host. This is useful for containers that want to use linux capabilities like manipulating the network stack and accessing devices.
how_to_solve: |
  Look at the following path to see what the settings are. 
  ```
  ...
    spec:
      containers:
      - securityContext:
          privileged: <privilege>
  ```
  https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
category: magalix.categories.pod-security
severity: high
targets: {kind: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
    CronJob]}
controls:
- magalix.controls.pci-dss.2.2.4
- magalix.controls.pci-dss.2.2.5
- magalix.controls.cis-benchmark.5.2.1
- magalix.controls.mitre-attack.4.1
- magalix.controls.nist-800-190.3.3.1
- magalix.controls.gdpr.25
- magalix.controls.gdpr.32
- magalix.controls.gdpr.24
- magalix.controls.soc2-type1.1.6.1
tags: [pci-dss, cis-benchmark, mitre-attack, nist800-190, gdpr, soc2-type1, default]
parameters:
- default:
  name: exclude_namespace
  required: false
  type: string
- default: false
  name: privilege
  required: true
  type: boolean
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
