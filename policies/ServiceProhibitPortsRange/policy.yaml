name: Services prohibit ports range
description: |
  This Policy checks if ports allocated for your services are using a number that is less than the specified value. 
how_to_solve: |
  Use a port that is greater than or equal to what is specified in the Policy. 
  ```
  spec:
    ports:
      - targetPort: <target_port>
  ```
category: magalix.categories.network-security
severity: high
targets: {kind: [Service]}
controls:
- magalix.controls.pci-dss.1.1.6
- magalix.controls.pci-dss.1.3.1
- magalix.controls.pci-dss.2.2.2
tags: [pci-dss]
parameters:
- default: 1024
  name: target_port
  required: true
  type: integer
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
