apiVersion: pac.weave.works/v1
kind: Policy
metadata:
  name: weave.policies.containers-should-not-run-in-namespace
spec:
  id: weave.policies.containers-should-not-run-in-namespace
  name: Containers Should Not Run In Namespace
  description: |
    This Policy ensure workloads are not running in a specified namespace. 
  how_to_solve: |
    Use a `namespace` that differs from the one specified in the Policy. 
    ```
    metadata:
      namespace: <custom_namespace>
    ```

    https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
  category: weave.categories.organizational-standards
  severity: low
  targets: {kinds: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet,
      StatefulSet, CronJob]}
  controls:
  - weave.controls.cis-benchmark.5.7.4
  - weave.controls.soc2-type-i.2.1.1
  tags: [cis-benchmark, soc2-type1]
  parameters:
  - name: custom_namespace
    type: string
    required: true
    value: default
  - name: exclude_label_key
    type: string
    required: false
    value:
  - name: exclude_label_value
    type: string
    required: false
    value:
  enabled: true
