name: Containers blocke ports range
description: |
  This Policy checks for container ports that are set below the set value. TCP ports under 1024 are reserved so we recommend setting your Policy to 1024 or higher. 
how_to_solve: |
  Choose ports over the value that is specified in the Policy. 
  ```
  ...
    spec:
      containers:
        - ports:
          - containerPort: <target_port>
  ```
  https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.txt
category: magalix.categories.network-security
severity: high
targets: {kind: [Deployment, Job, ReplicationController, ReplicaSet, DaemonSet, StatefulSet,
    CronJob]}
controls:
- magalix.controls.pci-dss.1.1.6
- magalix.controls.pci-dss.2.2.2
- magalix.controls.nist-800-190.4.4.2
tags: [pci-dss, nist800-190]
parameters:
- default: 1024
  name: target_port
  required: true
  type: integer
- default:
  name: exclude_namespace
  required: false
  type: string
- default:
  name: exclude_label_key
  required: false
  type: string
- default:
  name: exclude_label_value
  required: false
  type: string
