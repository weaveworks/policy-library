sync: true
enabled: true
name: MGLX_BLOCK_CONTAINER_PORT_22
description: |
  This Policy checks if the container is exposing ssh port (22).
risks: |
  Exposing ssh port (22) on containers increases your potential attack surface. This port maybe used by attackers to gain access to your container.
how_to_solve: |
  Make sure you are not exposing ssh port (22) on containers.
  ```
  ...
    spec:
      containers:
        ports:
        - containerPort: 22
  ```
category_id: 378583cc-4ae1-4793-99c1-f42fed213d16
severity: high
targets: [
  "Deployment",
  "Job",
  "ReplicationController",
  "ReplicaSet",
  "DaemonSet",
  "StatefulSet",
  "CronJob",
]
controls:
- e207c6f4-05fe-4a7b-82e3-d28627415eea
- f958b90a-e82b-4094-8ff5-940845d15399
- e0e6624b-9ecd-499d-89c3-be43171d2c24
tags: [
  "pci-dss",
]
exclusions:
- namespaces
- labels
auto_remedy: false
parameters:
- name: container_port
  type: integer
  required: true
  default: 22
- name: exclude_namespace
  type: string
  required: false
  default:
- name: exclude_label_key
  type: string
  required: false
  default:
- name: exclude_label_value
  type: string
  required: false
  default:
